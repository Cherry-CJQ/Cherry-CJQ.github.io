{% comment %} 纯 Liquid 拆斜杠多级树 {% endcomment %}
{% assign flat = site.categories | map: 'first' | sort %}
{% assign tree = '' | split: '' %}

{% for path in flat %}
  {% assign parts = path | split: '/' %}
  {% assign cursor = tree %}
  {% for part in parts %}
    {% comment %} 原生查找：遍历 cursor 看是否已存在同名节点 {% endcomment %}
    {% assign found = false %}
    {% for n in cursor %}
      {% if n.name == part %}{% assign found = true %}{% break %}{% endif %}
    {% endfor %}

    {% if found == false %}
      {% assign new_node = '' | split: '' %}
      {% assign new_node = new_node | push: part | map: 'name' %}
      {% assign new_node = new_node | push: '' | map: 'children' %}
      {% assign new_node = new_node | push: path | map: 'full_path' %}
      {% assign cursor = cursor | push: new_node %}
    {% endif %}

    {% comment %} 下移指针到 children {% endcomment %}
    {% for i in (0..cursor.size) %}
      {% if cursor[i].name == part %}
        {% assign cursor = cursor[i].children %}
        {% break %}
      {% endif %}
    {% endfor %}
  {% endfor %}
{% endfor %}